<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Flipbook Interaktif</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        /* Mengatur font untuk seluruh halaman */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            overflow: hidden; /* Menyembunyikan scrollbar yang mungkin muncul */
        }

        /* Container utama flipbook */
        .book-container {
            perspective: 2000px; /* Jarak pandang untuk efek 3D */
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
            width: 100%; /* Lebar penuh */
            height: 100%; /* Tinggi penuh */
        }

        /* Elemen buku (shell) */
        .book {
            width: 300px; /* Lebar standar buku */
            height: 500px; /* Tinggi standar buku */
            position: relative;
            transform-style: preserve-3d;
            transition: transform 0.8s ease-in-out;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            border-radius: 8px;
        }

        /* Halaman buku */
        .page {
            position: absolute;
            width: 100%;
            height: 100%;
            transform-origin: left center;
            transition: transform 0.8s ease-in-out;
            backface-visibility: hidden; /* Menyembunyikan sisi belakang */
            border-radius: 8px;
            overflow: hidden;
            box-sizing: border-box;
            border: 1px solid #ddd;
        }

        /* Konten halaman (gambar) */
        .page img {
            width: 100%;
            height: 100%;
            object-fit: cover; /* Memastikan gambar menutupi halaman tanpa terdistorsi */
            display: block;
        }

        /* Menyesuaikan lebar/tinggi buku berdasarkan rasio gambar */
        /* Rasio gambar adalah sekitar 1080x1920 (9:16) */
        .book {
            width: min(90vw, 300px); /* Maks 300px atau 90% lebar viewport */
            height: calc(min(90vw, 300px) * 16 / 9); /* Menjaga rasio 9:16 */
            max-height: 90vh; /* Tidak boleh lebih tinggi dari 90% viewport height */
        }

        /* Halaman depan (cover) */
        .page:first-child {
            z-index: 100;
        }

        /* Halaman ganjil (halaman kanan saat terbuka) */
        .page:nth-child(odd) {
            border-left: 1px solid #ccc;
        }

        /* Halaman genap (halaman kiri saat terbuka) */
        .page:nth-child(even) {
            transform-origin: right center; /* Titik putar di kanan */
            transform: rotateY(180deg);
            z-index: 1;
            border-right: 1px solid #ccc;
        }

        /* State halaman yang sudah terbalik */
        .flipped-front {
            transform: rotateY(-180deg); /* Membalik halaman ke kiri */
            z-index: 99;
        }

        .flipped-back {
            transform: rotateY(0deg); /* Menampilkan halaman belakang yang sudah terbalik (sekarang menjadi halaman kiri) */
            z-index: 10;
        }

        /* Tombol navigasi */
        .nav-button {
            z-index: 200;
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            padding: 1rem;
            border-radius: 50%;
            background-color: rgba(0, 0, 0, 0.4);
            color: white;
            transition: background-color 0.3s, transform 0.1s;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
            font-size: 1.5rem;
            user-select: none;
            line-height: 1; /* Agar simbol panah di tengah */
        }

        .nav-button:hover {
            background-color: rgba(0, 0, 0, 0.6);
        }
        
        .nav-button:active {
            transform: translateY(-50%) scale(0.95);
        }

        /* Posisi tombol */
        #prev-btn { left: 10px; }
        #next-btn { right: 10px; }

        /* Menyembunyikan tombol saat tidak diperlukan */
        .nav-button.hidden {
            opacity: 0;
            pointer-events: none;
        }

        /* Styling for the page number display */
        #page-info {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background-color: rgba(0, 0, 0, 0.5);
            color: white;
            padding: 5px 10px;
            border-radius: 4px;
            font-size: 0.85rem;
            z-index: 200;
        }
    </style>
</head>
<body class="bg-gray-100 flex flex-col justify-center items-center h-screen w-screen">

    <div class="book-container">
        <!-- Tombol Kembali -->
        <button id="prev-btn" class="nav-button left-4 hidden">
            &lsaquo;
        </button>

        <div id="book-element" class="book">
            <!-- Halaman-halaman akan diisi di sini oleh JavaScript -->
        </div>
        
        <!-- Tombol Selanjutnya -->
        <button id="next-btn" class="nav-button right-4">
            &rsaquo;
        </button>
    </div>

    <div id="page-info"></div>

    <script>
        // Memperbarui sumber gambar untuk menggunakan ID konten unik (contentFetchId) 
        // agar file yang diunggah dapat dimuat dengan benar.
        const IMAGE_SOURCES = [
            "uploaded:1000011841.png-d0214822-be1a-4670-84bb-f71a957e03eb", // Halaman 1 (Cover)
            "uploaded:1000011842.png-70c7332a-1f2c-4b54-ad16-f0647436337d", // Halaman 2 (Konten)
            "uploaded:1000011843.png-150f9881-e323-44f2-839b-5c716f90aa7d", // Halaman 3 (Konten)
            "uploaded:1000011844.png-e454dcea-c250-492e-9774-06c5f172f5ba", // Halaman 4 (Konten)
            "uploaded:1000011845.png-cbfd61de-4580-4270-b4af-6a7d958a7e70", // Halaman 5 (Konten)
            "uploaded:1000011846.png-238eaeae-5f49-4bb9-80b6-5e9d8ec5b4bb", // Halaman 6 (Konten)
            "uploaded:1000011847.png-ab5f1764-9bdb-43be-b2f9-d3228e7e854b"  // Halaman 7 (Konten Akhir)
        ];

        const book = document.getElementById('book-element');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const pageInfo = document.getElementById('page-info');
        const totalPages = IMAGE_SOURCES.length; // Menggunakan IMAGE_SOURCES
        let currentPage = 1; // Halaman yang sedang terlihat (1 adalah Cover)

        // --- Fungsi Utama Flipbook ---

        /**
         * Mengisi elemen buku dengan semua halaman gambar.
         */
        function renderPages() {
            IMAGE_SOURCES.forEach((sourceId, index) => { // Menggunakan sourceId
                const pageElement = document.createElement('div');
                // Halaman ganjil adalah sisi depan yang bisa dibalik (right page)
                // Halaman genap adalah sisi belakang (left page)
                pageElement.classList.add('page', 'absolute', 'bg-white', 'shadow-md', 'cursor-pointer');
                pageElement.setAttribute('data-page', index + 1);
                
                // Urutan z-index dihitung mundur agar halaman yang lebih awal berada di atas
                pageElement.style.zIndex = totalPages - index;
                
                // Tambahkan event listener untuk membalik halaman saat diklik
                pageElement.addEventListener('click', () => {
                    if (index + 1 === currentPage) {
                        nextPage();
                    } else if (index + 1 === currentPage - 1 && currentPage > 1) {
                         // Jika mengklik halaman genap (halaman kiri)
                        prevPage();
                    }
                });

                const img = document.createElement('img');
                img.src = sourceId; // Menggunakan sourceId sebagai src
                img.alt = `Halaman ${index + 1}`;
                img.draggable = false; // Mencegah gambar diseret
                
                pageElement.appendChild(img);
                book.appendChild(pageElement);
            });
        }

        /**
         * Memperbarui tampilan semua halaman berdasarkan currentPage saat ini.
         */
        function updateFlipbook() {
            const pages = book.querySelectorAll('.page');
            
            // Logika pembalikan:
            // Halaman 1, 3, 5, ... (ganjil) adalah sisi "depan"
            // Halaman 2, 4, 6, ... (genap) adalah sisi "belakang"
            
            pages.forEach((page, index) => {
                const pageNumber = index + 1;
                
                // Hapus semua kelas flip sebelumnya
                page.classList.remove('flipped-front', 'flipped-back');

                if (pageNumber < currentPage) {
                    // Halaman yang sudah terbalik sepenuhnya (berada di sisi kiri)
                    if (pageNumber % 2 !== 0) {
                        // Halaman ganjil yang sudah terbalik penuh
                        page.classList.add('flipped-front');
                        // Turunkan z-index untuk halaman yang sudah dibalik
                        page.style.zIndex = totalPages - index + 10;
                    } else {
                        // Halaman genap yang sudah terbalik penuh
                        page.classList.add('flipped-back');
                        page.style.zIndex = totalPages - index;
                    }

                } else if (pageNumber === currentPage) {
                    // Halaman yang sedang aktif (di kanan)
                    if (pageNumber % 2 !== 0) {
                        // Halaman ganjil yang belum dibalik
                        page.style.zIndex = 100 + totalPages - index; // Z-index tertinggi
                    } else {
                        // Halaman genap yang belum dibalik
                        page.style.zIndex = 10 + totalPages - index;
                    }

                } else {
                    // Halaman yang belum sampai (tersembunyi di bawah)
                    if (pageNumber % 2 !== 0) {
                        page.style.zIndex = totalPages - index;
                        // Pastikan halaman ganjil yang belum sampai posisinya normal
                        page.style.transform = 'rotateY(0deg)'; 
                    } else {
                        page.style.zIndex = totalPages - index;
                        // Pastikan halaman genap yang belum sampai posisinya terbalik
                        page.style.transform = 'rotateY(180deg)';
                    }
                }
            });

            // Perbarui tombol navigasi dan info halaman
            prevBtn.classList.toggle('hidden', currentPage <= 1);
            // Tombol 'next' tersembunyi jika kita berada di halaman terakhir (tidak ada halaman genap lagi yang tersisa)
            nextBtn.classList.toggle('hidden', currentPage > totalPages);
            
            // Tampilkan nomor halaman
            pageInfo.textContent = `Halaman ${Math.min(currentPage, totalPages)} dari ${totalPages}`;
        }

        /**
         * Pindah ke halaman berikutnya.
         */
        function nextPage() {
            if (currentPage < totalPages) {
                currentPage++;
                updateFlipbook();
            }
        }

        /**
         * Pindah ke halaman sebelumnya.
         */
        function prevPage() {
            if (currentPage > 1) {
                currentPage--;
                updateFlipbook();
            }
        }

        // --- Inisialisasi Aplikasi ---
        
        window.onload = function() {
            renderPages();
            updateFlipbook(); // Tampilkan halaman awal
            
            // Tambahkan event listener ke tombol
            nextBtn.addEventListener('click', nextPage);
            prevBtn.addEventListener('click', prevPage);
            
            // Tangani tombol keyboard (panah kiri/kanan)
            document.addEventListener('keydown', (e) => {
                if (e.key === 'ArrowRight') {
                    nextPage();
                } else if (e.key === 'ArrowLeft') {
                    prevPage();
                }
            });

            // Tambahkan event listener untuk sentuhan (swipe) pada body/container
            let touchstartX = 0;
            let touchendX = 0;

            const handleGesture = () => {
                const swipeThreshold = 50; // Jarak minimal swipe
                if (touchendX < touchstartX - swipeThreshold) {
                    // Swipe ke kiri (pindah ke halaman berikutnya)
                    nextPage();
                }

                if (touchendX > touchstartX + swipeThreshold) {
                    // Swipe ke kanan (pindah ke halaman sebelumnya)
                    prevPage();
                }
            }

            const bookContainer = document.querySelector('.book-container');
            bookContainer.addEventListener('touchstart', e => {
                touchstartX = e.changedTouches[0].screenX;
            }, false);

            bookContainer.addEventListener('touchend', e => {
                touchendX = e.changedTouches[0].screenX;
                handleGesture();
            }, false);
            
        }
    </script>
</body>
</html>

